#! /usr/bin/python
import subprocess
import sys
import re

def execute_cmd(cmd):
	p = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE)
	return p.stdout.read()

def main(name, count):
	cmd="gplaycli -c /home/android/android/apk_crawler/gplaycli/gplaycli.conf -s \"%s\" -n %d" %(name, count)
	
	result = execute_cmd(cmd)
	result = re.findall('\s[_|.|a-zA-Z0-9]*com[_|.|a-zA-Z0-9]*\s',result)
	
	print len(result)

	f=open("test_appid_list.txt","wb")
	for i in result:
		f.write(i.strip()+"\n")	
	f.close()
	

def Usage():
	print "./apk_list_get.py search_name list_len"
	exit(1)

if __name__=="__main__":
	if len(sys.argv) != 3:
		Usage()
	main(sys.argv[1], int(sys.argv[2]))
