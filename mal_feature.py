#!/usr/bin/env python
# -*- coding: utf-8 -*-

from apk_parse.apk import APK
import os


f = open("/home/android/android/mal_feature", 'w')
sep = '<sep>'
def find_apk():
        count = 1
	
        pwd = '/home/android/android/apk_sample/malware_app'
        for path, dir, files in os.walk(pwd):
       	        for file in files:
               	        if os.path.splitext(file)[1].lower()=='.apk':
                       	        get_feature('/home/android/android/apk_sample/malware_app/'+file)
                               	print count
                               	count = count + 1

def get_feature(apk_path):
	try:
		apkf = APK(apk_path)
		x_feature = ""	
		x_feature = x_feature + str(apkf.file_size) + sep
		x_feature = x_feature + str(apkf.get_activities()) + sep
		x_feature = x_feature + str(apkf.get_services()) + sep
		x_feature = x_feature + str(apkf.get_receivers()) + sep
		x_feature = x_feature + str(apkf.get_providers()) + sep
		x_feature = x_feature + str(apkf.get_permissions()) + "\n"
		f.write(x_feature)
	except:
		pass


if __name__ == "__main__":
	find_apk()
	f.close()
