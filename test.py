import make_x
import numpy as np
from numpy import argmax
from keras.models import Sequential
from keras.layers import Dense, Activation, Dropout

(trainX, trainY), (testX, testY) = make_x.data_load()
input_dim = trainX.shape[1]
model = Sequential()
x_val = trainX[:500]
x_train = trainX[500:]
y_val = trainY[:500]
y_train = trainY[500:]

#model.add(Dense(10, input_dim=input_dim, init='uniform', activation='relu'))
model.add(Dense(10, input_dim=input_dim, init='uniform', activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(40, init='uniform', activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(1, init='uniform', activation='sigmoid'))

model.compile(loss='binary_crossentropy', optimizer='adam',metrics=['accuracy'])

model.fit(x_train, y_train, epochs=35, batch_size=300, validation_data=(x_val, y_val))

model.summary()

print testX
predictions = model.predict(testX)
rounded = [x[0] for x in predictions]

yes=0
no=0
for i in range(500):
	pre = predictions[i]
	if pre != 0.0:
		pre = 1
	if pre == testY[i]:
		yes+=1
	else:
		no+=1
	print str(testY[i]) + " : " + str(pre)
print 'good count : ',yes
print 'fuck count : ',no
